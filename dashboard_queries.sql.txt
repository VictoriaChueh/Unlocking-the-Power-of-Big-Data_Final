Dashboard
SQL Editor1. Monthly Average Exchange Rate (Line Chart Data)-- 1) Monthly Average Exchange Rate (Line Chart Data)-- Query/Table Name: q_fx_monthly_avgWITH params AS (  SELECT    -- Fallback to safe boundaries when parameters are empty strings or NULL    COALESCE(NULLIF(:start_date, ''), '1900-01-01') AS start_date_s,    COALESCE(NULLIF(:end_date,   ''), '2999-12-31') AS end_date_s,    COALESCE(NULLIF(:ccy,        ''), 'USD')        AS ccy_s)SELECT  date_format(to_date(f.date), 'yyyy-MM') AS month,  AVG(f.rate) AS avg_rateFROM fx_rates_eur fCROSS JOIN params pWHERE f.currency = p.ccy_s  AND to_date(f.date) BETWEEN to_date(p.start_date_s) AND to_date(p.end_date_s)GROUP BY date_format(to_date(f.date), 'yyyy-MM')ORDER BY month;ion, c.country;2.  Month-over-Month Change of Monthly Average Exchange Rate (Table)-- 2) Month-over-Month Change of Monthly Average Exchange Rate (Table)-- Query/Table Name: q_fx_mom_changeWITH params AS (  SELECT    COALESCE(NULLIF(:start_date, ''), '1900-01-01') AS start_date_s,    COALESCE(NULLIF(:end_date,   ''), '2999-12-31') AS end_date_s,    COALESCE(NULLIF(:ccy,        ''), 'USD')        AS ccy_s),m AS (  SELECT    date_format(to_date(f.date), 'yyyy-MM') AS month,    AVG(f.rate) AS avg_rate  FROM fx_rates_eur f  CROSS JOIN params p  WHERE f.currency = p.ccy_s    AND to_date(f.date) BETWEEN to_date(p.start_date_s) AND to_date(p.end_date_s)  GROUP BY date_format(to_date(f.date), 'yyyy-MM'))SELECT  month,  avg_rate,  avg_rate - LAG(avg_rate) OVER (ORDER BY month) AS mom_changeFROM mORDER BY month;3. Total Population by Region (Bar Chart Data)-- 3) Total Population by Region (Bar Chart Data)-- Query/Table Name: q_population_by_regionSELECT  region,  SUM(population) AS total_populationFROM countries_currencyWHERE population IS NOT NULLGROUP BY regionORDER BY total_population DESC;4. Link Each Country¡¦s Currency to Its Average Rate Against EUR (Bubble Chart Data)-- 4) Link Each Country¡¦s Currency to Its Average Rate Against EUR (Bubble Chart Data)-- Query/Table Name: q_country_currency_avg_rateWITH avg_fx AS (  SELECT    currency,    AVG(rate) AS avg_rate_vs_eur  FROM fx_rates_eur  GROUP BY currency)SELECT  c.region,  c.country,  c.population,  c.currency,  a.avg_rate_vs_eurFROM countries_currency cJOIN avg_fx a  ON c.currency = a.currencyWHERE c.currency IS NOT NULLORDER BY c.region, c.country;Dataset1. Monthly Average Exchange Rate (Line Chart Data)WITH params AS (  SELECT    COALESCE(NULLIF(:start_date, ''), '1900-01-01') AS start_date_s,    COALESCE(NULLIF(:end_date,   ''), '2999-12-31') AS end_date_s,    COALESCE(NULLIF(:ccy,        ''), 'USD')        AS ccy_s)SELECT  date_format(to_date(f.date), 'yyyy-MM') AS month,  AVG(f.rate) AS avg_rateFROM fx_rates_eur fCROSS JOIN params pWHERE f.currency = p.ccy_s  AND to_date(f.date) BETWEEN to_date(p.start_date_s) AND to_date(p.end_date_s)GROUP BY date_format(to_date(f.date), 'yyyy-MM')ORDER BY month;
2.  Month-over-Month Change of Monthly Average Exchange Rate (Table)WITH params AS (  SELECT    COALESCE(NULLIF(:start_date, ''), '1900-01-01') AS start_date_s,    COALESCE(NULLIF(:end_date,   ''), '2999-12-31') AS end_date_s,    COALESCE(NULLIF(:ccy,        ''), 'USD')        AS ccy_s),m AS (  SELECT    date_format(to_date(f.date), 'yyyy-MM') AS month,    AVG(f.rate) AS avg_rate  FROM fx_rates_eur f  CROSS JOIN params p  WHERE f.currency = p.ccy_s    AND to_date(f.date) BETWEEN to_date(p.start_date_s) AND to_date(p.end_date_s)  GROUP BY date_format(to_date(f.date), 'yyyy-MM'))SELECT  month,  avg_rate,  avg_rate - LAG(avg_rate) OVER (ORDER BY month) AS mom_changeFROM mORDER BY month;3. Total Population by Region (Bar Chart Data)SELECT  region,  SUM(population) AS total_populationFROM countries_currencyWHERE population IS NOT NULLGROUP BY regionORDER BY total_population DESC;
4. Link Each Country¡¦s Currency to Its Average Rate Against EUR (Bubble Chart Data)WITH avg_fx AS (  SELECT    currency,    AVG(rate) AS avg_rate_vs_eur  FROM fx_rates_eur  WHERE currency IS NOT NULL  GROUP BY currency)SELECT  c.region,  c.country,  c.population,  c.currency,  a.avg_rate_vs_eurFROM countries_currency cJOIN avg_fx a  ON c.currency = a.currencyWHERE c.currency IS NOT NULL  AND c.population IS NOT NULLORDER BY c.region, c.country;